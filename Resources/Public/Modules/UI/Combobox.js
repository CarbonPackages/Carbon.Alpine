import{a as o,b as l}from"../chunk-G23S7GFF.js";function u(s){s.directive("combobox",(e,t,{evaluate:i})=>{t.value==="input"?c(e,s):t.value==="button"?p(e,s):t.value==="label"?f(e,s):t.value==="options"?b(e,s):t.value==="option"?$(e,s,t,i):h(e,s)}).before("bind"),s.magic("combobox",e=>{let t=s.$data(e);return{get value(){return t.__value},get isOpen(){return t.__isOpen},get isDisabled(){return t.__isDisabled},get activeOption(){let i=t.__context?.getActiveItem();return i&&i.value},get activeIndex(){let i=t.__context?.getActiveItem();return i?Object.values(s.raw(t.__context.items)).findIndex(a=>s.raw(i)==s.raw(a)):null}}}),s.magic("comboboxOption",e=>{let t=s.$data(e),i=s.findClosest(e,a=>a.hasAttribute("x-combobox:option"));if(!i)throw"No x-combobox:option directive found...";return{get isActive(){return t.__context.isActiveKey(s.$data(i).__optionKey)},get isSelected(){return t.__isSelected(i)},get isDisabled(){return t.__context.isDisabled(s.$data(i).__optionKey)}}})}function h(s,e){e.bind(s,{"x-id"(){return["alpine-combobox-button","alpine-combobox-options","alpine-combobox-label"]},"x-modelable":"__value","x-data"(){return{__ready:!1,__value:null,__isOpen:!1,__context:void 0,__isMultiple:void 0,__isStatic:!1,__isDisabled:void 0,__displayValue:void 0,__compareBy:null,__inputName:null,__isTyping:!1,__hold:!1,init(){this.__isMultiple=e.extractProp(s,"multiple",!1),this.__isDisabled=e.extractProp(s,"disabled",!1),this.__inputName=e.extractProp(s,"name",null),this.__nullable=e.extractProp(s,"nullable",!1),this.__compareBy=e.extractProp(s,"by"),this.__context=o(e,this.__isMultiple,"vertical",()=>this.__activateSelectedOrFirst());let t=e.extractProp(s,"default-value",this.__isMultiple?[]:null);this.__value=t,queueMicrotask(()=>{e.effect(()=>{this.__inputName&&l(e,this.$el,this.__inputName,this.__value)}),e.effect(()=>!this.__isMultiple&&this.__resetInput())})},__startTyping(){this.__isTyping=!0},__stopTyping(){this.__isTyping=!1},__resetInput(){let t=this.$refs.__input;if(!t)return;let i=this.__getCurrentValue();t.value=i},__getCurrentValue(){return!this.$refs.__input||!this.__value?"":this.__displayValue?this.__displayValue(this.__value):typeof this.__value=="string"?this.__value:""},__open(){if(this.__isOpen)return;this.__isOpen=!0;let t=this.$refs.__input;if(t){let a=t.value,{selectionStart:_,selectionEnd:n,selectionDirection:r}=t;t.value="",t.dispatchEvent(new Event("change")),t.value=a,r!==null?t.setSelectionRange(_,n,r):t.setSelectionRange(_,n)}(a=>requestAnimationFrame(()=>requestAnimationFrame(a)))(()=>{this.$refs.__input.focus({preventScroll:!0}),this.__activateSelectedOrFirst()})},__close(){this.__isOpen=!1,this.__context.deactivate()},__activateSelectedOrFirst(t=!0){if(!this.__isOpen||this.__context.hasActive()&&this.__context.wasActivatedByKeyPress())return;let i;if(this.__isMultiple){let _=this.__context.getItemsByValues(this.__value);i=_.length?_[0].value:null}else i=this.__value;let a=null;if(t&&i&&(a=this.__context.getItemByValue(i)),a){this.__context.activateAndScrollToKey(a.key);return}this.__context.activateAndScrollToKey(this.__context.firstKey())},__selectActive(){let t=this.__context.getActiveItem();t&&this.__toggleSelected(t.value)},__selectOption(t){let i=this.__context.getItemByEl(t);i&&this.__toggleSelected(i.value)},__isSelected(t){let i=this.__context.getItemByEl(t);return!i||!i.value?!1:this.__hasSelected(i.value)},__toggleSelected(t){if(!this.__isMultiple){this.__value=t;return}let i=this.__value.findIndex(a=>this.__compare(a,t));i===-1?this.__value.push(t):this.__value.splice(i,1)},__hasSelected(t){return this.__isMultiple?this.__value.some(i=>this.__compare(i,t)):this.__compare(this.__value,t)},__compare(t,i){let a=this.__compareBy;if(a||(a=(_,n)=>e.raw(_)===e.raw(n)),typeof a=="string"){let _=a;a=(n,r)=>!n||typeof n!="object"||!r||typeof r!="object"?e.raw(n)===e.raw(r):n[_]===r[_]}return a(t,i)}}},"@mousedown.window"(t){!this.$refs.__input.contains(t.target)&&!this.$refs.__button.contains(t.target)&&!this.$refs.__options.contains(t.target)&&(this.__close(),this.__resetInput())}})}function c(s,e){e.bind(s,{"x-ref":"__input",":id"(){return this.$id("alpine-combobox-input")},role:"combobox",tabindex:"0","aria-autocomplete":"list",async":aria-controls"(){return await d(()=>this.$refs.__options&&this.$refs.__options.id)},":aria-expanded"(){return this.$data.__isDisabled?void 0:this.$data.__isOpen},":aria-multiselectable"(){return this.$data.__isMultiple?!0:void 0},":aria-activedescendant"(){if(!this.$data.__context.hasActive())return;let t=this.$data.__context.getActiveItem();return t?t.el.id:null},":aria-labelledby"(){return this.$refs.__label?this.$refs.__label.id:this.$refs.__button?this.$refs.__button.id:null},"x-init"(){let t=e.extractProp(this.$el,"display-value");t&&(this.$data.__displayValue=t)},"@input.stop"(t){this.$data.__isTyping&&(this.$data.__open(),this.$dispatch("change"))},"@blur"(){this.$data.__stopTyping(!1)},"@keydown"(t){queueMicrotask(()=>this.$data.__context.activateByKeyEvent(t,!1,()=>this.$data.__isOpen,()=>this.$data.__open(),i=>this.$data.__isTyping=i))},"@keydown.enter.prevent.stop"(){this.$data.__selectActive(),this.$data.__stopTyping(),this.$data.__isMultiple||(this.$data.__close(),this.$data.__resetInput())},"@keydown.escape.prevent"(t){this.$data.__static||t.stopPropagation(),this.$data.__stopTyping(),this.$data.__close(),this.$data.__resetInput()},"@keydown.tab"(){this.$data.__stopTyping(),this.$data.__isOpen&&this.$data.__close(),this.$data.__resetInput()},"@keydown.backspace"(t){if(this.$data.__isMultiple||!this.$data.__nullable)return;let i=t.target;requestAnimationFrame(()=>{if(i.value===""){this.$data.__value=null;let a=this.$refs.__options;a&&(a.scrollTop=0),this.$data.__context.deactivate()}})}})}function p(s,e){e.bind(s,{"x-ref":"__button",":id"(){return this.$id("alpine-combobox-button")},"aria-haspopup":"true",async":aria-controls"(){return await d(()=>this.$refs.__options&&this.$refs.__options.id)},":aria-labelledby"(){return this.$refs.__label?[this.$refs.__label.id,this.$el.id].join(" "):null},":aria-expanded"(){return this.$data.__isDisabled?null:this.$data.__isOpen},":disabled"(){return this.$data.__isDisabled},tabindex:"-1","x-init"(){this.$el.tagName.toLowerCase()==="button"&&!this.$el.hasAttribute("type")&&(this.$el.type="button")},"@click"(t){this.$data.__isDisabled||(this.$data.__isOpen?(this.$data.__close(),this.$data.__resetInput()):(t.preventDefault(),this.$data.__open()),this.$nextTick(()=>this.$refs.__input.focus({preventScroll:!0})))}})}function f(s,e){e.bind(s,{"x-ref":"__label",":id"(){return this.$id("alpine-combobox-label")},"@click"(){this.$refs.__input.focus({preventScroll:!0})}})}function b(s,e){e.bind(s,{"x-ref":"__options",":id"(){return this.$id("alpine-combobox-options")},role:"listbox",":aria-labelledby"(){return this.$refs.__label?this.$refs.__label.id:this.$refs.__button?this.$refs.__button.id:null},"x-init"(){this.$data.__isStatic=e.bound(this.$el,"static",!1),e.bound(this.$el,"hold")&&(this.$data.__hold=!0)},"x-show"(){return this.$data.__isStatic?!0:this.$data.__isOpen}})}function $(s,e){e.bind(s,{"x-id"(){return["alpine-combobox-option"]},":id"(){return this.$id("alpine-combobox-option")},role:"option",":tabindex"(){return this.$comboboxOption.isDisabled?void 0:"-1"},"x-effect"(){this.$comboboxOption.isSelected?s.setAttribute("aria-selected",!0):s.setAttribute("aria-selected",!1)},":aria-disabled"(){return this.$comboboxOption.isDisabled},"x-data"(){return{__optionKey:null,init(){this.__optionKey=(Math.random()+1).toString(36).substring(7);let t=e.extractProp(this.$el,"value"),i=e.extractProp(this.$el,"disabled",!1,!1);this.__context.registerItem(this.__optionKey,this.$el,t,i)},destroy(){this.__context.unregisterItem(this.__optionKey)}}},"@click"(){this.$comboboxOption.isDisabled||(this.__selectOption(this.$el),this.__isMultiple||(this.__close(),this.__resetInput()),this.$nextTick(()=>this.$refs.__input.focus({preventScroll:!0})))},"@mouseenter"(t){this.__context.activateEl(this.$el)},"@mousemove"(t){this.__context.isActiveEl(this.$el)||this.__context.activateEl(this.$el)},"@mouseleave"(t){this.__hold||this.__context.deactivate()}})}function d(s){return new Promise(e=>queueMicrotask(()=>e(s())))}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(u)});
