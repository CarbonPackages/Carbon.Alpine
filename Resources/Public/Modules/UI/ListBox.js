import{a as o,b as l}from"../chunk-G23S7GFF.js";function u(a){a.directive("listbox",(e,t)=>{t.value?t.value==="label"?c(e,a):t.value==="button"?h(e,a):t.value==="options"?p(e,a):t.value==="option"&&f(e,a):d(e,a)}).before("bind"),a.magic("listbox",e=>{let t=a.$data(e);return{get selected(){return t.__value},get active(){let i=t.__context.getActiveItem();return i&&i.value},get value(){return t.__value},get isOpen(){return t.__isOpen},get isDisabled(){return t.__isDisabled},get activeOption(){let i=t.__context.getActiveItem();return i&&i.value},get activeIndex(){let i=t.__context.getActiveItem();return i&&i.key}}}),a.magic("listboxOption",e=>{let t=a.$data(e),i=a.findClosest(e,s=>s.hasAttribute("x-listbox:option"));if(!i)throw"No x-listbox:option directive found...";return{get isActive(){return t.__context.isActiveKey(a.$data(i).__optionKey)},get isSelected(){return t.__isSelected(i)},get isDisabled(){return t.__context.isDisabled(a.$data(i).__optionKey)}}})}function d(a,e){e.bind(a,{"x-id"(){return["alpine-listbox-button","alpine-listbox-options","alpine-listbox-label"]},"x-modelable":"__value","x-data"(){return{__ready:!1,__value:null,__isOpen:!1,__context:void 0,__isMultiple:void 0,__isStatic:!1,__isDisabled:void 0,__compareBy:null,__inputName:null,__orientation:"vertical",__hold:!1,init(){this.__isMultiple=e.extractProp(a,"multiple",!1),this.__isDisabled=e.extractProp(a,"disabled",!1),this.__inputName=e.extractProp(a,"name",null),this.__compareBy=e.extractProp(a,"by"),this.__orientation=e.extractProp(a,"horizontal",!1)?"horizontal":"vertical",this.__context=o(e,this.__isMultiple,this.__orientation,()=>this.$data.__activateSelectedOrFirst());let t=e.extractProp(a,"default-value",this.__isMultiple?[]:null);this.__value=t,queueMicrotask(()=>{e.effect(()=>{this.__inputName&&l(e,this.$el,this.__inputName,this.__value)}),e.effect(()=>{this.__resetInput()})})},__resetInput(){let t=this.$refs.__input;if(!t)return;let i=this.$data.__getCurrentValue();t.value=i},__getCurrentValue(){return!this.$refs.__input||!this.__value?"":this.$data.__displayValue&&this.__value!==void 0?this.$data.__displayValue(this.__value):typeof this.__value=="string"?this.__value:""},__open(){if(this.__isOpen)return;this.__isOpen=!0,this.__activateSelectedOrFirst(),(i=>requestAnimationFrame(()=>requestAnimationFrame(i)))(()=>this.$refs.__options.focus({preventScroll:!0}))},__close(){this.__isOpen=!1,this.__context.deactivate(),this.$nextTick(()=>this.$refs.__button.focus({preventScroll:!0}))},__activateSelectedOrFirst(t=!0){if(!this.__isOpen)return;if(this.__context.getActiveKey()){this.__context.activateAndScrollToKey(this.__context.getActiveKey());return}let i;if(this.__isMultiple?i=this.__value.find(s=>!!this.__context.getItemByValue(s)):i=this.__value,t&&i){let s=this.__context.getItemByValue(i);s&&this.__context.activateAndScrollToKey(s.key)}else this.__context.activateAndScrollToKey(this.__context.firstKey())},__selectActive(){let t=this.$data.__context.getActiveItem();t&&this.__toggleSelected(t.value)},__selectOption(t){let i=this.__context.getItemByEl(t);i&&this.__toggleSelected(i.value)},__isSelected(t){let i=this.__context.getItemByEl(t);return!i||!i.value?!1:this.__hasSelected(i.value)},__toggleSelected(t){if(!this.__isMultiple){this.__value=t;return}let i=this.__value.findIndex(s=>this.__compare(s,t));i===-1?this.__value.push(t):this.__value.splice(i,1)},__hasSelected(t){return this.__isMultiple?this.__value.some(i=>this.__compare(i,t)):this.__compare(this.__value,t)},__compare(t,i){let s=this.__compareBy;if(s||(s=(n,_)=>e.raw(n)===e.raw(_)),typeof s=="string"){let n=s;s=(_,r)=>!_||typeof _!="object"||!r||typeof r!="object"?e.raw(_)===e.raw(r):_[n]===r[n]}return s(t,i)}}}})}function c(a,e){e.bind(a,{"x-ref":"__label",":id"(){return this.$id("alpine-listbox-label")},"@click"(){this.$refs.__button.focus({preventScroll:!0})}})}function h(a,e){e.bind(a,{"x-ref":"__button",":id"(){return this.$id("alpine-listbox-button")},"aria-haspopup":"true",":aria-labelledby"(){return this.$id("alpine-listbox-label")},":aria-expanded"(){return this.$data.__isOpen},":aria-controls"(){return this.$data.__isOpen&&this.$id("alpine-listbox-options")},"x-init"(){this.$el.tagName.toLowerCase()==="button"&&!this.$el.hasAttribute("type")&&(this.$el.type="button")},"@click"(){this.$data.__open()},"@keydown"(t){["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(t.key)&&(t.stopPropagation(),t.preventDefault(),this.$data.__open())},"@keydown.space.stop.prevent"(){this.$data.__open()},"@keydown.enter.stop.prevent"(){this.$data.__open()}})}function p(a,e){e.bind(a,{"x-ref":"__options",":id"(){return this.$id("alpine-listbox-options")},role:"listbox",tabindex:"0",":aria-orientation"(){return this.$data.__orientation},":aria-labelledby"(){return this.$id("alpine-listbox-button")},":aria-activedescendant"(){if(!this.$data.__context.hasActive())return;let t=this.$data.__context.getActiveItem();return t?t.el.id:null},"x-init"(){this.$data.__isStatic=e.extractProp(this.$el,"static",!1),e.bound(this.$el,"hold")&&(this.$data.__hold=!0)},"x-show"(){return this.$data.__isStatic?!0:this.$data.__isOpen},"x-trap"(){return this.$data.__isOpen},"@click.outside"(){this.$data.__close()},"@keydown.escape.stop.prevent"(){this.$data.__close()},"@focus"(){this.$data.__activateSelectedOrFirst()},"@keydown"(t){queueMicrotask(()=>this.$data.__context.activateByKeyEvent(t,!0,()=>this.$data.__isOpen,()=>this.$data.__open(),()=>{}))},"@keydown.enter.stop.prevent"(){this.$data.__selectActive(),this.$data.__isMultiple||this.$data.__close()},"@keydown.space.stop.prevent"(){this.$data.__selectActive(),this.$data.__isMultiple||this.$data.__close()}})}function f(a,e){e.bind(a,()=>({"x-id"(){return["alpine-listbox-option"]},":id"(){return this.$id("alpine-listbox-option")},role:"option",":tabindex"(){return this.$listboxOption.isDisabled?!1:"-1"},":aria-selected"(){return this.$listboxOption.isSelected},"x-data"(){return{__optionKey:null,init(){this.__optionKey=(Math.random()+1).toString(36).substring(7);let t=e.extractProp(a,"value"),i=e.extractProp(a,"disabled",!1,!1);this.$data.__context.registerItem(this.__optionKey,a,t,i)},destroy(){this.$data.__context.unregisterItem(this.__optionKey)}}},"@click"(){this.$listboxOption.isDisabled||(this.$data.__selectOption(a),this.$data.__isMultiple||this.$data.__close())},"@mouseenter"(){this.$data.__context.activateEl(a)},"@mouseleave"(){this.$data.__hold||this.$data.__context.deactivate()}}))}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(u)});
