import{a as r,b as o}from"../chunk-TDNU3FAA.js";function l(a){a.directive("listbox",(i,t)=>{t.value?t.value==="label"?c(i,a):t.value==="button"?h(i,a):t.value==="options"?p(i,a):t.value==="option"&&f(i,a):d(i,a)}).before("bind"),a.magic("listbox",i=>{let t=a.$data(i);return{get selected(){return t.__value},get active(){let e=t.__context.getActiveItem();return e&&e.value},get value(){return t.__value},get isOpen(){return t.__isOpen},get isDisabled(){return t.__isDisabled},get activeOption(){let e=t.__context.getActiveItem();return e&&e.value},get activeIndex(){let e=t.__context.getActiveItem();return e&&e.key}}}),a.magic("listboxOption",i=>{let t=a.$data(i),e=a.findClosest(i,s=>s.__optionKey);if(!e)throw"No x-combobox:option directive found...";return{get isActive(){return t.__context.isActiveKey(e.__optionKey)},get isSelected(){return t.__isSelected(e)},get isDisabled(){return t.__context.isDisabled(e.__optionKey)}}})}function d(a,i){i.bind(a,{"x-id"(){return["alpine-listbox-button","alpine-listbox-options","alpine-listbox-label"]},"x-modelable":"__value","x-data"(){return{__ready:!1,__value:null,__isOpen:!1,__context:void 0,__isMultiple:void 0,__isStatic:!1,__isDisabled:void 0,__compareBy:null,__inputName:null,__orientation:"vertical",__hold:!1,init(){this.__isMultiple=i.extractProp(a,"multiple",!1),this.__isDisabled=i.extractProp(a,"disabled",!1),this.__inputName=i.extractProp(a,"name",null),this.__compareBy=i.extractProp(a,"by"),this.__orientation=i.extractProp(a,"horizontal",!1)?"horizontal":"vertical",this.__context=r(i,this.__isMultiple,this.__orientation,()=>this.$data.__activateSelectedOrFirst());let t=i.extractProp(a,"default-value",this.__isMultiple?[]:null);this.__value=t,queueMicrotask(()=>{i.effect(()=>{this.__inputName&&o(i,this.$el,this.__inputName,this.__value)}),i.effect(()=>{this.__resetInput()})})},__resetInput(){let t=this.$refs.__input;if(!t)return;let e=this.$data.__getCurrentValue();t.value=e},__getCurrentValue(){return!this.$refs.__input||!this.__value?"":this.$data.__displayValue&&this.__value!==void 0?this.$data.__displayValue(this.__value):typeof this.__value=="string"?this.__value:""},__open(){if(this.__isOpen)return;this.__isOpen=!0,this.__activateSelectedOrFirst(),(e=>requestAnimationFrame(()=>requestAnimationFrame(e)))(()=>this.$refs.__options.focus({preventScroll:!0}))},__close(){this.__isOpen=!1,this.__context.deactivate(),this.$nextTick(()=>this.$refs.__button.focus({preventScroll:!0}))},__activateSelectedOrFirst(t=!0){if(!this.__isOpen)return;if(this.__context.activeKey){this.__context.activateAndScrollToKey(this.__context.activeKey);return}let e;if(this.__isMultiple?e=this.__value.find(s=>!!this.__context.getItemByValue(s)):e=this.__value,t&&e){let s=this.__context.getItemByValue(e);s&&this.__context.activateAndScrollToKey(s.key)}else this.__context.activateAndScrollToKey(this.__context.firstKey())},__selectActive(){let t=this.$data.__context.getActiveItem();t&&this.__toggleSelected(t.value)},__selectOption(t){let e=this.__context.getItemByEl(t);e&&this.__toggleSelected(e.value)},__isSelected(t){let e=this.__context.getItemByEl(t);return!e||!e.value?!1:this.__hasSelected(e.value)},__toggleSelected(t){if(!this.__isMultiple){this.__value=t;return}let e=this.__value.findIndex(s=>this.__compare(s,t));e===-1?this.__value.push(t):this.__value.splice(e,1)},__hasSelected(t){return this.__isMultiple?this.__value.some(e=>this.__compare(e,t)):this.__compare(this.__value,t)},__compare(t,e){let s=this.__compareBy;if(s||(s=(_,n)=>i.raw(_)===i.raw(n)),typeof s=="string"){let _=s;s=(n,u)=>n[_]===u[_]}return s(t,e)}}}})}function c(a,i){i.bind(a,{"x-ref":"__label",":id"(){return this.$id("alpine-listbox-label")},"@click"(){this.$refs.__button.focus({preventScroll:!0})}})}function h(a,i){i.bind(a,{"x-ref":"__button",":id"(){return this.$id("alpine-listbox-button")},"aria-haspopup":"true",":aria-labelledby"(){return this.$id("alpine-listbox-label")},":aria-expanded"(){return this.$data.__isOpen},":aria-controls"(){return this.$data.__isOpen&&this.$id("alpine-listbox-options")},"x-init"(){this.$el.tagName.toLowerCase()==="button"&&!this.$el.hasAttribute("type")&&(this.$el.type="button")},"@click"(){this.$data.__open()},"@keydown"(t){["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(t.key)&&(t.stopPropagation(),t.preventDefault(),this.$data.__open())},"@keydown.space.stop.prevent"(){this.$data.__open()},"@keydown.enter.stop.prevent"(){this.$data.__open()}})}function p(a,i){i.bind(a,{"x-ref":"__options",":id"(){return this.$id("alpine-listbox-options")},role:"listbox",tabindex:"0",":aria-orientation"(){return this.$data.__orientation},":aria-labelledby"(){return this.$id("alpine-listbox-button")},":aria-activedescendant"(){if(!this.$data.__context.hasActive())return;let t=this.$data.__context.getActiveItem();return t?t.el.id:null},"x-init"(){this.$data.__isStatic=i.extractProp(this.$el,"static",!1),i.bound(this.$el,"hold")&&(this.$data.__hold=!0)},"x-show"(){return this.$data.__isStatic?!0:this.$data.__isOpen},"x-trap"(){return this.$data.__isOpen},"@click.outside"(){this.$data.__close()},"@keydown.escape.stop.prevent"(){this.$data.__close()},"@focus"(){this.$data.__activateSelectedOrFirst()},"@keydown"(t){queueMicrotask(()=>this.$data.__context.activateByKeyEvent(t,!0,()=>this.$data.__isOpen,()=>this.$data.__open(),()=>{}))},"@keydown.enter.stop.prevent"(){this.$data.__selectActive(),this.$data.__isMultiple||this.$data.__close()},"@keydown.space.stop.prevent"(){this.$data.__selectActive(),this.$data.__isMultiple||this.$data.__close()}})}function f(a,i){i.bind(a,()=>({"x-id"(){return["alpine-listbox-option"]},":id"(){return this.$id("alpine-listbox-option")},role:"option",":tabindex"(){return this.$listboxOption.isDisabled?!1:"-1"},":aria-selected"(){return this.$listboxOption.isSelected},"x-data"(){return{init(){let t=a.__optionKey=(Math.random()+1).toString(36).substring(7),e=i.extractProp(a,"value"),s=i.extractProp(a,"disabled",!1,!1);this.$data.__context.registerItem(t,a,e,s)},destroy(){this.$data.__context.unregisterItem(this.$el.__optionKey)}}},"@click"(){this.$listboxOption.isDisabled||(this.$data.__selectOption(a),this.$data.__isMultiple||this.$data.__close())},"@mouseenter"(){this.$data.__context.activateEl(a)},"@mouseleave"(){this.$data.__hold||this.$data.__context.deactivate()}}))}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(l)});
