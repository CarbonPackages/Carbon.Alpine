(()=>{var k=ENV.RELEASE_DATE||"v1";function E(s){s.magic("fetch",()=>async(e,{maxAgeInSeconds:a=0,prefix:i="alpine-fetch-",version:t=k,cache:n=!0}={})=>n?await w({url:e,prefix:i,version:t,maxAgeInSeconds:a,forceFlush:n==="flush"}):await fetch(e)),s.data("fetch",(e,a,i,t,n="replace",h=!0,o=300,r=!0,l)=>({noMarkup:!1,target:null,fetched:!1,noContentFound(u){if(this.$dispatch("fetch-no-content",{url:e,element:this.$el,target:this.target}),u&&console.error(u),a){this.noMarkup=!0;return}this.$el.remove()},init(){let u=this.$el,p=this.$refs.target||u;if(this.target=p,!e||typeof e!="string"){this.noContentFound("No URL defined in x-data='fetch'");return}let R=e.split("||");Promise.all(R.map(async c=>{let f=r?await w({url:c,prefix:"alpine-fetch-",version:l,maxAgeInSeconds:o,forceFlush:r==="flush"}):await fetch(c);if(!f?.ok)throw new Error("Network response was not ok "+JSON.stringify(f));return f.json()})).then(c=>{let f={};c.forEach(F=>{F.forEach(m=>{(!h||m.url!=window.location.pathname)&&(f[m.url]=m.markup)})});let d=Object.values(f);i&&(d=d.slice(0,i));let g=d.join("");if(!g){if(t)throw new Error("No Markup found");this.noContentFound(null);return}if(this.fetched=!0,this.$dispatch("fetch-has-content",{url:e,element:u,target:p}),n==="replace"){p.innerHTML=g;return}p.insertAdjacentHTML(n,g)}).catch(c=>{this.fetched=!0,this.noContentFound(c)})}}))}async function w({url:s="",prefix:e="alpine-",version:a=k,maxAgeInSeconds:i=0,forceFlush:t=!1}={}){if(!("caches"in window))return fetch(s);let n=`${e}${a}`;if(t)await b(n,e,!0);else{let r=await y(n,s,i);if(r!==!1&&r!==void 0)return new Promise(l=>l(r))}await(await caches.open(n)).add(s);let o=await y(n,s);return t||await b(n,e),new Promise((r,l)=>{(o===!1||!o?.ok)&&l(o),r(o)})}async function y(s,e,a=0){let t=await(await caches.open(s)).match(e);if(!t?.ok)return t;let n=a>0?t.headers.get("date"):null;if(n){let h=new Date(n);if(h&&Date.now()>h.getTime()+1e3*a)return!1}return t}async function b(s,e,a=!1){let i=await caches.keys();for(let t of i)t.startsWith(e.toString())&&(a||s!==t)&&caches.delete(t)}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(E)});})();
