(()=>{function c(r,a,t,s){return{items:[],activeKey:null,orderedKeys:[],activatedByKeyPress:!1,activateSelectedOrFirst:r.debounce(function(){s(!1)}),registerItem(e,i,n,l){this.items.push({key:e,el:i,value:n,disabled:l}),this.orderedKeys.push(e),this.reorderKeys(),this.activateSelectedOrFirst()},unregisterItem(e){let i=this.items.findIndex(n=>n.key===e);i!==-1&&this.items.splice(i,1),i=this.orderedKeys.indexOf(e),i!==-1&&this.orderedKeys.splice(i,1),this.reorderKeys(),this.activateSelectedOrFirst()},getItemByKey(e){return this.items.find(i=>i.key===e)},getItemByValue(e){return this.items.find(i=>r.raw(i.value)===r.raw(e))},getItemByEl(e){return this.items.find(i=>i.el===e)},getItemsByValues(e){let i=e.map(l=>r.raw(l)),n=this.items.filter(l=>i.includes(r.raw(l.value)));return n=n.slice().sort((l,_)=>{let o=l.el.compareDocumentPosition(_.el);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0}),n},getActiveItem(){if(!this.hasActive())return null;let e=this.items.find(i=>i.key===this.activeKey);return e||this.deactivateKey(this.activeKey),e},activateItem(e){e&&this.activateKey(e.key)},reorderKeys:r.debounce(function(){this.orderedKeys=this.items.map(e=>e.key),this.orderedKeys=this.orderedKeys.slice().sort((e,i)=>{if(e===null||i===null)return 0;let n=this.items.find(o=>o.key===e).el,l=this.items.find(o=>o.key===i).el,_=n.compareDocumentPosition(l);return _&Node.DOCUMENT_POSITION_FOLLOWING?-1:_&Node.DOCUMENT_POSITION_PRECEDING?1:0}),this.orderedKeys.includes(this.activeKey)||this.deactivateKey(this.activeKey)}),activeEl(){if(this.activeKey)return this.items.find(e=>e.key===this.activeKey).el},isActiveEl(e){let i=this.items.find(n=>n.el===e);return this.activeKey===i},activateEl(e){let i=this.items.find(n=>n.el===e);this.activateKey(i.key)},isDisabledEl(e){return this.items.find(i=>i.el===e).disabled},get isScrollingTo(){return this.scrollingCount>0},scrollingCount:0,activateAndScrollToKey(e,i){if(!this.getItemByKey(e))return;this.scrollingCount++,this.activateKey(e,i),this.items.find(l=>l.key===e).el.scrollIntoView({block:"nearest"}),setTimeout(()=>{this.scrollingCount--},25)},isDisabled(e){let i=this.items.find(n=>n.key===e);return i?i.disabled:!1},get nonDisabledOrderedKeys(){return this.orderedKeys.filter(e=>!this.isDisabled(e))},hasActive(){return!!this.activeKey},wasActivatedByKeyPress(){return this.activatedByKeyPress},isActiveKey(e){return this.activeKey===e},activateKey(e,i=!1){this.isDisabled(e)||(this.activeKey=e,this.activatedByKeyPress=i)},deactivateKey(e){this.activeKey===e&&(this.activeKey=null,this.activatedByKeyPress=!1)},deactivate(){this.activeKey&&(this.isScrollingTo||(this.activeKey=null,this.activatedByKeyPress=!1))},nextKey(){if(!this.activeKey)return;let e=this.nonDisabledOrderedKeys.findIndex(i=>i===this.activeKey);return this.nonDisabledOrderedKeys[e+1]},prevKey(){if(!this.activeKey)return;let e=this.nonDisabledOrderedKeys.findIndex(i=>i===this.activeKey);return this.nonDisabledOrderedKeys[e-1]},firstKey(){return this.nonDisabledOrderedKeys[0]},lastKey(){return this.nonDisabledOrderedKeys[this.nonDisabledOrderedKeys.length-1]},searchQuery:"",clearSearch:r.debounce(function(){this.searchQuery=""},350),searchKey(e){this.clearSearch(),this.searchQuery+=e;let i;for(let n in this.items)if(this.items[n].el.textContent.trim().toLowerCase().startsWith(this.searchQuery)){i=this.items[n].key;break}if(this.nonDisabledOrderedKeys.includes(i))return i},activateByKeyEvent(e,i=!1,n=()=>!1,l=()=>{},_){let o,d;_(!0);let u=!0;switch(e.key){case["ArrowDown","ArrowRight"][t==="vertical"?0:1]:if(e.preventDefault(),e.stopPropagation(),_(!1),!n()){l();break}this.reorderKeys(),d=this.hasActive(),o=d?this.nextKey():this.firstKey();break;case["ArrowUp","ArrowLeft"][t==="vertical"?0:1]:if(e.preventDefault(),e.stopPropagation(),_(!1),!n()){l();break}this.reorderKeys(),d=this.hasActive(),o=d?this.prevKey():this.lastKey();break;case"Home":case"PageUp":if(e.key=="Home"&&e.shiftKey)return;e.preventDefault(),e.stopPropagation(),_(!1),this.reorderKeys(),d=this.hasActive(),o=this.firstKey();break;case"End":case"PageDown":if(e.key=="End"&&e.shiftKey)return;e.preventDefault(),e.stopPropagation(),_(!1),this.reorderKeys(),d=this.hasActive(),o=this.lastKey();break;default:u=this.activatedByKeyPress,i&&e.key.length===1&&(o=this.searchKey(e.key));break}o&&this.activateAndScrollToKey(o,u)}}}function h(r,a,t,s){let e=f(t,s);e.forEach(l=>l._x_hiddenInput=!0),e.forEach(l=>l._x_ignore=!0);let i=a.children,n=[];for(let l=0;l<i.length;l++){let _=i[l];if(_._x_hiddenInput)n.push(_);else break}r.mutateDom(()=>{n.forEach(l=>l.remove()),e.reverse().forEach(l=>a.prepend(l))})}function f(r,a,t=[]){if(v(a))for(let s in a)t=t.concat(f(`${r}[${s}]`,a[s]));else{let s=document.createElement("input");return s.setAttribute("type","hidden"),s.setAttribute("name",r),s.setAttribute("value",""+a),[s]}return t}function v(r){return typeof r=="object"&&r!==null}function y(r){r.directive("listbox",(a,t)=>{t.value?t.value==="label"?b(a,r):t.value==="button"?x(a,r):t.value==="options"?K(a,r):t.value==="option"&&m(a,r):p(a,r)}).before("bind"),r.magic("listbox",a=>{let t=r.$data(a);return{get selected(){return t.__value},get active(){let s=t.__context.getActiveItem();return s&&s.value},get value(){return t.__value},get isOpen(){return t.__isOpen},get isDisabled(){return t.__isDisabled},get activeOption(){let s=t.__context.getActiveItem();return s&&s.value},get activeIndex(){let s=t.__context.getActiveItem();return s&&s.key}}}),r.magic("listboxOption",a=>{let t=r.$data(a),s=r.findClosest(a,e=>e.__optionKey);if(!s)throw"No x-combobox:option directive found...";return{get isActive(){return t.__context.isActiveKey(s.__optionKey)},get isSelected(){return t.__isSelected(s)},get isDisabled(){return t.__context.isDisabled(s.__optionKey)}}})}function p(r,a){a.bind(r,{"x-id"(){return["alpine-listbox-button","alpine-listbox-options","alpine-listbox-label"]},"x-modelable":"__value","x-data"(){return{__ready:!1,__value:null,__isOpen:!1,__context:void 0,__isMultiple:void 0,__isStatic:!1,__isDisabled:void 0,__compareBy:null,__inputName:null,__orientation:"vertical",__hold:!1,init(){this.__isMultiple=a.extractProp(r,"multiple",!1),this.__isDisabled=a.extractProp(r,"disabled",!1),this.__inputName=a.extractProp(r,"name",null),this.__compareBy=a.extractProp(r,"by"),this.__orientation=a.extractProp(r,"horizontal",!1)?"horizontal":"vertical",this.__context=c(a,this.__isMultiple,this.__orientation,()=>this.$data.__activateSelectedOrFirst());let t=a.extractProp(r,"default-value",this.__isMultiple?[]:null);this.__value=t,queueMicrotask(()=>{a.effect(()=>{this.__inputName&&h(a,this.$el,this.__inputName,this.__value)}),a.effect(()=>{this.__resetInput()})})},__resetInput(){let t=this.$refs.__input;if(!t)return;let s=this.$data.__getCurrentValue();t.value=s},__getCurrentValue(){return!this.$refs.__input||!this.__value?"":this.$data.__displayValue&&this.__value!==void 0?this.$data.__displayValue(this.__value):typeof this.__value=="string"?this.__value:""},__open(){if(this.__isOpen)return;this.__isOpen=!0,this.__activateSelectedOrFirst(),(s=>requestAnimationFrame(()=>requestAnimationFrame(s)))(()=>this.$refs.__options.focus({preventScroll:!0}))},__close(){this.__isOpen=!1,this.__context.deactivate(),this.$nextTick(()=>this.$refs.__button.focus({preventScroll:!0}))},__activateSelectedOrFirst(t=!0){if(!this.__isOpen)return;if(this.__context.activeKey){this.__context.activateAndScrollToKey(this.__context.activeKey);return}let s;if(this.__isMultiple?s=this.__value.find(e=>!!this.__context.getItemByValue(e)):s=this.__value,t&&s){let e=this.__context.getItemByValue(s);e&&this.__context.activateAndScrollToKey(e.key)}else this.__context.activateAndScrollToKey(this.__context.firstKey())},__selectActive(){let t=this.$data.__context.getActiveItem();t&&this.__toggleSelected(t.value)},__selectOption(t){let s=this.__context.getItemByEl(t);s&&this.__toggleSelected(s.value)},__isSelected(t){let s=this.__context.getItemByEl(t);return!s||!s.value?!1:this.__hasSelected(s.value)},__toggleSelected(t){if(!this.__isMultiple){this.__value=t;return}let s=this.__value.findIndex(e=>this.__compare(e,t));s===-1?this.__value.push(t):this.__value.splice(s,1)},__hasSelected(t){return this.__isMultiple?this.__value.some(s=>this.__compare(s,t)):this.__compare(this.__value,t)},__compare(t,s){let e=this.__compareBy;if(e||(e=(i,n)=>a.raw(i)===a.raw(n)),typeof e=="string"){let i=e;e=(n,l)=>n[i]===l[i]}return e(t,s)}}}})}function b(r,a){a.bind(r,{"x-ref":"__label",":id"(){return this.$id("alpine-listbox-label")},"@click"(){this.$refs.__button.focus({preventScroll:!0})}})}function x(r,a){a.bind(r,{"x-ref":"__button",":id"(){return this.$id("alpine-listbox-button")},"aria-haspopup":"true",":aria-labelledby"(){return this.$id("alpine-listbox-label")},":aria-expanded"(){return this.$data.__isOpen},":aria-controls"(){return this.$data.__isOpen&&this.$id("alpine-listbox-options")},"x-init"(){this.$el.tagName.toLowerCase()==="button"&&!this.$el.hasAttribute("type")&&(this.$el.type="button")},"@click"(){this.$data.__open()},"@keydown"(t){["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(t.key)&&(t.stopPropagation(),t.preventDefault(),this.$data.__open())},"@keydown.space.stop.prevent"(){this.$data.__open()},"@keydown.enter.stop.prevent"(){this.$data.__open()}})}function K(r,a){a.bind(r,{"x-ref":"__options",":id"(){return this.$id("alpine-listbox-options")},role:"listbox",tabindex:"0",":aria-orientation"(){return this.$data.__orientation},":aria-labelledby"(){return this.$id("alpine-listbox-button")},":aria-activedescendant"(){if(!this.$data.__context.hasActive())return;let t=this.$data.__context.getActiveItem();return t?t.el.id:null},"x-init"(){this.$data.__isStatic=a.extractProp(this.$el,"static",!1),a.bound(this.$el,"hold")&&(this.$data.__hold=!0)},"x-show"(){return this.$data.__isStatic?!0:this.$data.__isOpen},"x-trap"(){return this.$data.__isOpen},"@click.outside"(){this.$data.__close()},"@keydown.escape.stop.prevent"(){this.$data.__close()},"@focus"(){this.$data.__activateSelectedOrFirst()},"@keydown"(t){queueMicrotask(()=>this.$data.__context.activateByKeyEvent(t,!0,()=>this.$data.__isOpen,()=>this.$data.__open(),()=>{}))},"@keydown.enter.stop.prevent"(){this.$data.__selectActive(),this.$data.__isMultiple||this.$data.__close()},"@keydown.space.stop.prevent"(){this.$data.__selectActive(),this.$data.__isMultiple||this.$data.__close()}})}function m(r,a){a.bind(r,()=>({"x-id"(){return["alpine-listbox-option"]},":id"(){return this.$id("alpine-listbox-option")},role:"option",":tabindex"(){return this.$listboxOption.isDisabled?!1:"-1"},":aria-selected"(){return this.$listboxOption.isSelected},"x-data"(){return{init(){let t=r.__optionKey=(Math.random()+1).toString(36).substring(7),s=a.extractProp(r,"value"),e=a.extractProp(r,"disabled",!1,!1);this.$data.__context.registerItem(t,r,s,e)},destroy(){this.$data.__context.unregisterItem(this.$el.__optionKey)}}},"@click"(){this.$listboxOption.isDisabled||(this.$data.__selectOption(r),this.$data.__isMultiple||this.$data.__close())},"@mouseenter"(){this.$data.__context.activateEl(r)},"@mouseleave"(){this.$data.__hold||this.$data.__context.deactivate()}}))}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(y)});})();
