(()=>{function c(i,s,l){return{searchableText:{},disabledKeys:[],activeKey:null,selectedKeys:[],orderedKeys:[],elsByKey:{},values:{},initItem(e,t,r){let a=(Math.random()+1).toString(36).substring(7);return this.values[a]=t,this.elsByKey[a]=e,this.orderedKeys.push(a),this.searchableText[a]=e.textContent.trim().toLowerCase(),r&&this.disabledKeys.push(a),a},destroyItem(e){let t=o(this.elsByKey,e);delete this.values[t],delete this.elsByKey[t],delete this.orderedKeys[this.orderedKeys.indexOf(t)],delete this.searchableText[t],delete this.disabledKeys[t],this.reorderKeys()},reorderKeys(){this.orderedKeys.forEach(e=>{let t=this.elsByKey[e];t.isConnected||this.destroyItem(t)}),this.orderedKeys=this.orderedKeys.slice().sort((e,t)=>{if(e===null||t===null)return 0;let r=this.elsByKey[e],a=this.elsByKey[t],n=r.compareDocumentPosition(a);return n&Node.DOCUMENT_POSITION_FOLLOWING?-1:n&Node.DOCUMENT_POSITION_PRECEDING?1:0})},activeEl(){if(this.activeKey)return this.elsByKey[this.activeKey]},isActiveEl(e){let t=o(this.elsByKey,e);if(t)return this.activeKey===t},activateEl(e){let t=o(this.elsByKey,e);t&&this.activateKey(t)},selectEl(e){let t=o(this.elsByKey,e);t&&this.selectKey(t)},isSelectedEl(e){let t=o(this.elsByKey,e);if(t)return this.isSelected(t)},isDisabledEl(e){let t=o(this.elsByKey,e);if(t)return this.isDisabled(t)},get isScrollingTo(){return this.scrollingCount>0},scrollingCount:0,activateAndScrollToKey(e){this.scrollingCount++,this.activateKey(e),this.elsByKey[e].scrollIntoView({block:"nearest"}),setTimeout(()=>{this.scrollingCount--},25)},selectedValueOrValues(){return i?this.selectedValues():this.selectedValue()},selectedValues(){return this.selectedKeys.map(e=>this.values[e])},selectedValue(){return this.selectedKeys[0]?this.values[this.selectedKeys[0]]:null},selectValue(e,t){if(e||(e=i?[]:null),t||(t=(r,a)=>r===a),typeof t=="string"){let r=t;t=(a,n)=>a[r]===n[r]}if(i){let r=[];e.forEach(a=>{for(let n in this.values)t(this.values[n],a)&&(r.includes(n)||r.push(n))}),this.selectExclusive(r)}else for(let r in this.values)e&&t(this.values[r],e)&&this.selectKey(r)},isDisabled(e){return this.disabledKeys.includes(e)},get nonDisabledOrderedKeys(){return this.orderedKeys.filter(e=>!this.isDisabled(e))},selectKey(e){this.isDisabled(e)||(i?this.toggleSelected(e):this.selectOnly(e))},toggleSelected(e){this.selectedKeys.includes(e)?this.selectedKeys.splice(this.selectedKeys.indexOf(e),1):this.selectedKeys.push(e)},selectOnly(e){this.selectedKeys=[],this.selectedKeys.push(e)},selectExclusive(e){let t=[...e];for(let r=0;r<this.selectedKeys.length;r++){if(e.includes(this.selectedKeys[r])){delete t[t.indexOf(this.selectedKeys[r])];continue}e.includes(this.selectedKeys[r])||delete this.selectedKeys[r]}t.forEach(r=>{this.selectedKeys.push(r)})},selectActive(e){this.activeKey&&this.selectKey(this.activeKey)},isSelected(e){return this.selectedKeys.includes(e)},firstSelectedKey(){return this.selectedKeys[0]},hasActive(){return!!this.activeKey},isActiveKey(e){return this.activeKey===e},get active(){return this.hasActive()&&this.values[this.activeKey]},activateSelectedOrFirst(){let e=this.firstSelectedKey();if(e)return this.activateKey(e);let t=this.firstKey();t&&this.activateKey(t)},activateKey(e){this.isDisabled(e)||(this.activeKey=e)},deactivate(){this.activeKey&&(this.isScrollingTo||(this.activeKey=null))},nextKey(){if(!this.activeKey)return;let e=this.nonDisabledOrderedKeys.findIndex(t=>t===this.activeKey);return this.nonDisabledOrderedKeys[e+1]},prevKey(){if(!this.activeKey)return;let e=this.nonDisabledOrderedKeys.findIndex(t=>t===this.activeKey);return this.nonDisabledOrderedKeys[e-1]},firstKey(){return this.nonDisabledOrderedKeys[0]},lastKey(){return this.nonDisabledOrderedKeys[this.nonDisabledOrderedKeys.length-1]},searchQuery:"",clearSearch:l.debounce(function(){this.searchQuery=""},350),searchKey(e){this.clearSearch(),this.searchQuery+=e;let t;for(let r in this.searchableText)if(this.searchableText[r].startsWith(this.searchQuery)){t=r;break}if(this.nonDisabledOrderedKeys.includes(t))return t},activateByKeyEvent(e){this.reorderKeys();let t=this.hasActive(),r;switch(e.key){case"Tab":case"Backspace":case"Delete":case"Meta":break;case["ArrowDown","ArrowRight"][s==="vertical"?0:1]:e.preventDefault(),e.stopPropagation(),r=t?this.nextKey():this.firstKey();break;case["ArrowUp","ArrowLeft"][s==="vertical"?0:1]:e.preventDefault(),e.stopPropagation(),r=t?this.prevKey():this.lastKey();break;case"Home":case"PageUp":e.preventDefault(),e.stopPropagation(),r=this.firstKey();break;case"End":case"PageDown":e.preventDefault(),e.stopPropagation(),r=this.lastKey();break;default:e.key.length===1&&(r=this.searchKey(e.key));break}r&&this.activateAndScrollToKey(r)}}}function o(i,s){return Object.keys(i).find(l=>i[l]===s)}function u(i,s,l,e){let t=h(s,l);t.forEach(n=>n._x_hiddenInput=!0),t.forEach(n=>n._x_ignore=!0);let r=i.children,a=[];for(let n=0;n<r.length;n++){let d=r[n];if(d._x_hiddenInput)a.push(d);else break}e.mutateDom(()=>{a.forEach(n=>n.remove()),t.reverse().forEach(n=>i.prepend(n))})}function h(i,s,l=[]){if(y(s))for(let e in s)l=l.concat(h(`${i}[${e}]`,s[e]));else{let e=document.createElement("input");return e.setAttribute("type","hidden"),e.setAttribute("name",i),e.setAttribute("value",""+s),[e]}return l}function y(i){return typeof i=="object"&&i!==null}function _(i){i.directive("listbox",(s,l)=>{l.value?l.value==="label"?p(s,i):l.value==="button"?K(s,i):l.value==="options"?b(s,i):l.value==="option"&&v(s,i):f(s,i)}),i.magic("listbox",s=>{let l=i.$data(s);return l.__ready?{get isOpen(){return l.__isOpen},get isDisabled(){return l.__isDisabled},get selected(){return l.__value},get active(){return l.__context.active}}:{isDisabled:!1,isOpen:!1,selected:null,active:null}}),i.magic("listboxOption",s=>{let l=i.$data(s),e={isDisabled:!1,isSelected:!1,isActive:!1};if(!l.__ready)return e;let t=i.findClosest(s,a=>a.__optionKey);if(!t)return e;let r=l.__context;return{get isActive(){return r.isActiveEl(t)},get isSelected(){return r.isSelectedEl(t)},get isDisabled(){return r.isDisabledEl(t)}}})}function f(i,s){s.bind(i,{"x-id"(){return["alpine-listbox-button","alpine-listbox-options","alpine-listbox-label"]},"x-modelable":"__value","x-data"(){return{__ready:!1,__value:null,__isOpen:!1,__context:void 0,__isMultiple:void 0,__isStatic:!1,__isDisabled:void 0,__compareBy:null,__inputName:null,__orientation:"vertical",init(){this.__isMultiple=s.bound(i,"multiple",!1),this.__isDisabled=s.bound(i,"disabled",!1),this.__inputName=s.bound(i,"name",null),this.__compareBy=s.bound(i,"by"),this.__orientation=s.bound(i,"horizontal",!1)?"horizontal":"vertical",this.__context=c(this.__isMultiple,this.__orientation,s);let l=s.bound(i,"default-value",null);this.__value=l,queueMicrotask(()=>{this.__ready=!0,queueMicrotask(()=>{let e=!1;s.effect(()=>{this.__context.selectedKeys,e===!1||e!==JSON.stringify(this.__value)?this.__context.selectValue(this.__value,this.__compareBy):this.__value=this.__context.selectedValueOrValues(),e=JSON.stringify(this.__value),this.__inputName&&u(this.$el,this.__inputName,this.__value,s)})})})},__open(){this.__isOpen=!0,this.__context.activateSelectedOrFirst(),(e=>requestAnimationFrame(()=>requestAnimationFrame(e)))(()=>this.$refs.__options.focus({preventScroll:!0}))},__close(){this.__isOpen=!1,this.$nextTick(()=>this.$refs.__button.focus({preventScroll:!0}))}}}})}function p(i,s){s.bind(i,{"x-ref":"__label",":id"(){return this.$id("alpine-listbox-label")},"@click"(){this.$refs.__button.focus({preventScroll:!0})}})}function K(i,s){s.bind(i,{"x-ref":"__button",":id"(){return this.$id("alpine-listbox-button")},"aria-haspopup":"true",":aria-labelledby"(){return this.$id("alpine-listbox-label")},":aria-expanded"(){return this.$data.__isOpen},":aria-controls"(){return this.$data.__isOpen&&this.$id("alpine-listbox-options")},"x-init"(){this.$el.tagName.toLowerCase()==="button"&&!this.$el.hasAttribute("type")&&(this.$el.type="button")},"@click"(){this.$data.__open()},"@keydown"(l){["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(l.key)&&(l.stopPropagation(),l.preventDefault(),this.$data.__open())},"@keydown.space.stop.prevent"(){this.$data.__open()},"@keydown.enter.stop.prevent"(){this.$data.__open()}})}function b(i,s){s.bind(i,{"x-ref":"__options",":id"(){return this.$id("alpine-listbox-options")},"x-init"(){this.$data.__isStatic=s.bound(this.$el,"static",!1)},"x-show"(){return this.$data.__isStatic?!0:this.$data.__isOpen},"@click.outside"(){this.$data.__close()},"@keydown.escape.stop.prevent"(){this.$data.__close()},tabindex:"0",role:"listbox",":aria-orientation"(){return this.$data.__orientation},":aria-labelledby"(){return this.$id("alpine-listbox-button")},":aria-activedescendant"(){return this.__context.activeEl()&&this.__context.activeEl().id},"@focus"(){this.__context.activateSelectedOrFirst()},"x-trap"(){return this.$data.__isOpen},"@keydown"(l){this.__context.activateByKeyEvent(l)},"@keydown.enter.stop.prevent"(){this.__context.selectActive(),this.$data.__isMultiple||this.$data.__close()},"@keydown.space.stop.prevent"(){this.__context.selectActive(),this.$data.__isMultiple||this.$data.__close()}})}function v(i,s){s.bind(i,()=>({":id"(){return this.$id("alpine-listbox-option")},":tabindex"(){return this.$listbox.isDisabled?!1:"-1"},role:"option","x-init"(){queueMicrotask(()=>{let l=s.bound(i,"value"),e=s.bound(i,"disabled");i.__optionKey=this.$data.__context.initItem(i,l,e)})},":aria-selected"(){return this.$listboxOption.isSelected},"@click"(){this.$listboxOption.isDisabled||(this.$data.__context.selectEl(i),this.$data.__isMultiple||this.$data.__close())},"@mousemove"(){this.$data.__context.activateEl(i)},"@mouseleave"(){this.$data.__context.deactivate()}}))}window.addEventListener("alpine:init",()=>{window.Alpine.plugin(_)});})();
